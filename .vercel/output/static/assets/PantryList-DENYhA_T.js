import{r as a,j as t}from"./framer-motion-DexFYn3r.js";import{e as J,i as Q,l as Z,k as $,P as ee,j as T,m as te,$ as re,F as se,h as F,B as D}from"./index-o6bm3qdW.js";import{c as G,R as ne,A as oe,C as ae,b as ie,a as le}from"./index-BMd2TyCU.js";import{C as ce}from"./checkbox-CElA_Qfn.js";import{M as de,T as ue,b as pe,a as xe,P as fe}from"./tags-41O2HsC5.js";import{P as he}from"./pencil-DTPZJ6bb.js";import{T as me}from"./trash-2-CpjvPaTx.js";import"./index-B3hHUwxe.js";import"./check-BwO51OGf.js";var[E,Ue]=J("Tooltip",[G]),k=G(),B="TooltipProvider",ve=700,L="tooltip.open",[ge,M]=E(B),q=e=>{const{__scopeTooltip:s,delayDuration:r=ve,skipDelayDuration:n=300,disableHoverableContent:o=!1,children:d}=e,[i,f]=a.useState(!0),l=a.useRef(!1),p=a.useRef(0);return a.useEffect(()=>{const u=p.current;return()=>window.clearTimeout(u)},[]),t.jsx(ge,{scope:s,isOpenDelayed:i,delayDuration:r,onOpen:a.useCallback(()=>{window.clearTimeout(p.current),f(!1)},[]),onClose:a.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>f(!0),n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:a.useCallback(u=>{l.current=u},[]),disableHoverableContent:o,children:d})};q.displayName=B;var R="Tooltip",[ye,_]=E(R),U=e=>{const{__scopeTooltip:s,children:r,open:n,defaultOpen:o=!1,onOpenChange:d,disableHoverableContent:i,delayDuration:f}=e,l=M(R,e.__scopeTooltip),p=k(s),[u,x]=a.useState(null),h=Q(),c=a.useRef(0),m=i??l.disableHoverableContent,g=f??l.delayDuration,v=a.useRef(!1),[j=!1,y]=Z({prop:n,defaultProp:o,onChange:S=>{S?(l.onOpen(),document.dispatchEvent(new CustomEvent(L))):l.onClose(),d==null||d(S)}}),b=a.useMemo(()=>j?v.current?"delayed-open":"instant-open":"closed",[j]),w=a.useCallback(()=>{window.clearTimeout(c.current),c.current=0,v.current=!1,y(!0)},[y]),N=a.useCallback(()=>{window.clearTimeout(c.current),c.current=0,y(!1)},[y]),H=a.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>{v.current=!0,y(!0),c.current=0},g)},[g,y]);return a.useEffect(()=>()=>{c.current&&(window.clearTimeout(c.current),c.current=0)},[]),t.jsx(ne,{...p,children:t.jsx(ye,{scope:s,contentId:h,open:j,stateAttribute:b,trigger:u,onTriggerChange:x,onTriggerEnter:a.useCallback(()=>{l.isOpenDelayed?H():w()},[l.isOpenDelayed,H,w]),onTriggerLeave:a.useCallback(()=>{m?N():(window.clearTimeout(c.current),c.current=0)},[N,m]),onOpen:w,onClose:N,disableHoverableContent:m,children:r})})};U.displayName=R;var I="TooltipTrigger",V=a.forwardRef((e,s)=>{const{__scopeTooltip:r,...n}=e,o=_(I,r),d=M(I,r),i=k(r),f=a.useRef(null),l=$(s,f,o.onTriggerChange),p=a.useRef(!1),u=a.useRef(!1),x=a.useCallback(()=>p.current=!1,[]);return a.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),t.jsx(oe,{asChild:!0,...i,children:t.jsx(ee.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...n,ref:l,onPointerMove:T(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!d.isPointerInTransitRef.current&&(o.onTriggerEnter(),u.current=!0)}),onPointerLeave:T(e.onPointerLeave,()=>{o.onTriggerLeave(),u.current=!1}),onPointerDown:T(e.onPointerDown,()=>{p.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:T(e.onFocus,()=>{p.current||o.onOpen()}),onBlur:T(e.onBlur,o.onClose),onClick:T(e.onClick,o.onClose)})})});V.displayName=I;var je="TooltipPortal",[Ve,Te]=E(je,{forceMount:void 0}),C="TooltipContent",Y=a.forwardRef((e,s)=>{const r=Te(C,e.__scopeTooltip),{forceMount:n=r.forceMount,side:o="top",...d}=e,i=_(C,e.__scopeTooltip);return t.jsx(te,{present:n||i.open,children:i.disableHoverableContent?t.jsx(X,{side:o,...d,ref:s}):t.jsx(Ce,{side:o,...d,ref:s})})}),Ce=a.forwardRef((e,s)=>{const r=_(C,e.__scopeTooltip),n=M(C,e.__scopeTooltip),o=a.useRef(null),d=$(s,o),[i,f]=a.useState(null),{trigger:l,onClose:p}=r,u=o.current,{onPointerInTransitChange:x}=n,h=a.useCallback(()=>{f(null),x(!1)},[x]),c=a.useCallback((m,g)=>{const v=m.currentTarget,j={x:m.clientX,y:m.clientY},y=Pe(j,v.getBoundingClientRect()),b=Ee(j,y),w=ke(g.getBoundingClientRect()),N=_e([...b,...w]);f(N),x(!0)},[x]);return a.useEffect(()=>()=>h(),[h]),a.useEffect(()=>{if(l&&u){const m=v=>c(v,u),g=v=>c(v,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",g)}}},[l,u,c,h]),a.useEffect(()=>{if(i){const m=g=>{const v=g.target,j={x:g.clientX,y:g.clientY},y=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),b=!Re(j,i);y?h():b&&(h(),p())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,i,p,h]),t.jsx(X,{...e,ref:d})}),[be,we]=E(R,{isInside:!1}),X=a.forwardRef((e,s)=>{const{__scopeTooltip:r,children:n,"aria-label":o,onEscapeKeyDown:d,onPointerDownOutside:i,...f}=e,l=_(C,r),p=k(r),{onClose:u}=l;return a.useEffect(()=>(document.addEventListener(L,u),()=>document.removeEventListener(L,u)),[u]),a.useEffect(()=>{if(l.trigger){const x=h=>{const c=h.target;c!=null&&c.contains(l.trigger)&&u()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[l.trigger,u]),t.jsx(re,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:d,onPointerDownOutside:i,onFocusOutside:x=>x.preventDefault(),onDismiss:u,children:t.jsxs(ae,{"data-state":l.stateAttribute,...p,...f,ref:s,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[t.jsx(se,{children:n}),t.jsx(be,{scope:r,isInside:!0,children:t.jsx(ie,{id:l.contentId,role:"tooltip",children:o||n})})]})})});Y.displayName=C;var K="TooltipArrow",Ne=a.forwardRef((e,s)=>{const{__scopeTooltip:r,...n}=e,o=k(r);return we(K,r).isInside?null:t.jsx(le,{...o,...n,ref:s})});Ne.displayName=K;function Pe(e,s){const r=Math.abs(s.top-e.y),n=Math.abs(s.bottom-e.y),o=Math.abs(s.right-e.x),d=Math.abs(s.left-e.x);switch(Math.min(r,n,o,d)){case d:return"left";case o:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Ee(e,s,r=5){const n=[];switch(s){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function ke(e){const{top:s,right:r,bottom:n,left:o}=e;return[{x:o,y:s},{x:r,y:s},{x:r,y:n},{x:o,y:n}]}function Re(e,s){const{x:r,y:n}=e;let o=!1;for(let d=0,i=s.length-1;d<s.length;i=d++){const f=s[d].x,l=s[d].y,p=s[i].x,u=s[i].y;l>n!=u>n&&r<(p-f)*(n-l)/(u-l)+f&&(o=!o)}return o}function _e(e){const s=e.slice();return s.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),De(s)}function De(e){if(e.length<=1)return e.slice();const s=[];for(let n=0;n<e.length;n++){const o=e[n];for(;s.length>=2;){const d=s[s.length-1],i=s[s.length-2];if((d.x-i.x)*(o.y-i.y)>=(d.y-i.y)*(o.x-i.x))s.pop();else break}s.push(o)}s.pop();const r=[];for(let n=e.length-1;n>=0;n--){const o=e[n];for(;r.length>=2;){const d=r[r.length-1],i=r[r.length-2];if((d.x-i.x)*(o.y-i.y)>=(d.y-i.y)*(o.x-i.x))r.pop();else break}r.push(o)}return r.pop(),s.length===1&&r.length===1&&s[0].x===r[0].x&&s[0].y===r[0].y?s:s.concat(r)}var Ae=q,Oe=U,Le=V,W=Y;const z=Ae,A=Oe,O=Le,P=a.forwardRef(({className:e,sideOffset:s=4,...r},n)=>t.jsx(W,{ref:n,sideOffset:s,className:F("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));P.displayName=W.displayName;function Ie({item:e,onEdit:s,onDelete:r,isSelectionMode:n,isSelected:o,onSelectItem:d}){var u,x,h;const[i,f]=a.useState(!1),l=e.expiry_date&&new Date(e.expiry_date)<new Date,p=c=>{n&&!(c.target instanceof Element&&(c.target.closest("button")||c.target.closest('[role="checkbox"]')))&&d(e.id)};return t.jsxs("div",{className:F("flex items-start p-2 border-b hover:bg-muted/50",n&&"cursor-pointer",o&&"bg-primary/10 hover:bg-primary/15"),onClick:p,children:[n&&t.jsxs("div",{className:"flex items-center justify-center px-3 py-2 w-10 flex-shrink-0",children:[" ",t.jsx(ce,{id:`select-row-${e.id}`,checked:o,onCheckedChange:()=>d(e.id),"aria-label":`Seleccionar ${((u=e.ingredient)==null?void 0:u.name)||"item"}`,onClick:c=>c.stopPropagation()})]}),t.jsxs("div",{className:"flex-1 font-medium pr-3 py-2",children:[t.jsx("div",{children:((x=e.ingredient)==null?void 0:x.name)||"Ingrediente Desconocido"}),(e.location||e.price!=null)&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-1 flex flex-wrap gap-x-2 gap-y-0.5",children:[e.location&&t.jsxs("span",{className:"flex items-center",children:[t.jsx(de,{size:10,className:"mr-1"})," ",e.location]}),e.price!=null&&t.jsxs("span",{className:"flex items-center",children:[t.jsx(ue,{size:10,className:"mr-1"})," $",e.price.toFixed(2)]})]}),e.notes&&t.jsx(z,{delayDuration:100,children:t.jsxs(A,{children:[t.jsx(O,{asChild:!0,children:t.jsxs(D,{variant:"ghost",size:"icon",className:"h-5 w-5 mt-1 text-muted-foreground",onClick:c=>{c.stopPropagation(),f(!i)},children:[" ",t.jsx(pe,{size:12})]})}),t.jsx(P,{children:t.jsxs("p",{className:"text-xs",children:[i?"Ocultar":"Mostrar"," notas"]})})]})}),e.tags&&e.tags.length>0&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-1 flex items-center gap-1 flex-wrap",children:[t.jsx(xe,{size:10,className:"flex-shrink-0"}),e.tags.map(c=>t.jsx("span",{className:"text-[10px] px-1 py-0 bg-secondary text-secondary-foreground rounded",children:c},c))]})]}),t.jsxs("div",{className:"px-3 py-2",children:[t.jsx("div",{children:e.quantity??"-"}),(e.min_stock!=null||e.target_stock!=null)&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-1 flex items-center gap-1",title:`Stock: Min ${e.min_stock??"N/A"} / Obj ${e.target_stock??"N/A"}`,children:[t.jsx(fe,{size:10}),"(",e.min_stock??"_"," - ",e.target_stock??"_",")"]})]}),t.jsx("div",{className:"px-3 py-2 flex-shrink-0",children:e.unit||"-"}),t.jsx("div",{className:"px-3 py-2",children:(h=e.category)!=null&&h.name?t.jsxs(t.Fragment,{children:[" ",t.jsx("span",{className:"text-xs",children:e.category.name})]}):t.jsx("span",{className:"text-xs text-muted-foreground",children:"Sin cat."})}),t.jsxs("div",{className:`px-3 py-2 text-xs flex-shrink-0 ${l?"text-destructive font-medium":""}`,children:[e.expiry_date||"-",l&&t.jsx("span",{className:"ml-1 text-[9px] px-1 py-0 leading-none text-destructive-foreground bg-destructive rounded",children:"(V)"})]}),!n&&t.jsx("div",{className:"text-right space-x-1 pl-3 py-2 flex-shrink-0",children:t.jsxs(z,{delayDuration:100,children:[t.jsxs(A,{children:[t.jsx(O,{asChild:!0,children:t.jsxs(D,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:c=>{c.stopPropagation(),s(e)},children:[" ",t.jsx(he,{className:"h-3 w-3"}),t.jsx("span",{className:"sr-only",children:"Editar"})]})}),t.jsx(P,{children:t.jsx("p",{className:"text-xs",children:"Editar"})})]}),t.jsxs(A,{children:[t.jsx(O,{asChild:!0,children:t.jsxs(D,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:c=>{c.stopPropagation(),r(e.id)},children:[" ",t.jsx(me,{className:"h-3 w-3"}),t.jsx("span",{className:"sr-only",children:"Eliminar"})]})}),t.jsx(P,{children:t.jsx("p",{className:"text-xs",children:"Eliminar"})})]})]})}),n&&t.jsxs("div",{className:"pl-3 py-2 flex-shrink-0 w-[76px]",children:[" ","  "]})]})}const Ye=({items:e,onEdit:s,onDelete:r,isSelectionMode:n,selectedItems:o,onSelectItem:d})=>!e||e.length===0?t.jsx("div",{className:"text-center py-10 text-muted-foreground",id:"pantry-empty-state",children:"Tu despensa está vacía. ¡Añade algunos items!"}):t.jsx("div",{className:"h-[400px] overflow-y-auto rounded-md border",children:t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex w-full bg-muted/50 border-b",children:[n&&t.jsx("div",{className:"p-3 w-10 flex-shrink-0"}),t.jsx("div",{className:"flex-1 p-3 font-medium",children:"Nombre"}),t.jsx("div",{className:"p-3 font-medium",children:"Cantidad"}),t.jsx("div",{className:"p-3 font-medium flex-shrink-0",children:"Unidad"}),t.jsx("div",{className:"p-3 font-medium",children:"Categoría"}),t.jsx("div",{className:"p-3 font-medium flex-shrink-0",children:"Caducidad"}),t.jsx("div",{className:"p-3 font-medium text-right flex-shrink-0",children:"Acciones"})]}),t.jsx("div",{className:"w-full",children:e.map(i=>t.jsx(Ie,{item:i,onEdit:s,onDelete:r,isSelectionMode:n,isSelected:o.has(i.id),onSelectItem:d},i.id))})]})});export{Ye as default};
